#ifndef _GAME_H_
#define _GAME_H_


#include <vector>
#include <iostream>
#include <algorithm>
#include <stdio.h>
#include <stdlib.h>
//#include <cstring>
#include <string.h>

using namespace std;


enum {
	HAI_NUMBER = 136,
	DORA_SHOW_INDEX = 131,
};

enum state {
	
	EAST_TSUMO = 0x01,
	SOUTH_TSUMO = 0x02,
	WEST_TSUMO = 0x03,
	NORTH_TSUMO = 0x04,
	EAST_KIRU = 0x11,
	SOUTH_KIRU = 0x12,
	WEST_KIRU = 0x13,
	NORTH_KIRU = 0x14,
	OVER = 0x00,
};


// Hai type unsigned char
const Hai HaiData[HAI_NUMBER] = {
	// m
	0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,
	0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,
	0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,
	0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,	
	// p
	0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,
	0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,
	0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,
	0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,
	// s
	0x21,0x22,0x23,0x24,0x25,0x26,0x27,0x28,0x29,
	0x21,0x22,0x23,0x24,0x25,0x26,0x27,0x28,0x29,
	0x21,0x22,0x23,0x24,0x25,0x26,0x27,0x28,0x29,
	0x21,0x22,0x23,0x24,0x25,0x26,0x27,0x28,0x29,
	// z
	// east, south, west, north, chu, haku, hatsu
	0x31,0x32,0x33,0x34,0x35,0x36,0x37,
	0x31,0x32,0x33,0x34,0x35,0x36,0x37,
	0x31,0x32,0x33,0x34,0x35,0x36,0x37,
	0x31,0x32,0x33,0x34,0x35,0x36,0x37,
};
	
//class Player;
//class User;
class Game{
private:
	vector<class Player*> aPlayers;
	vector<class Player*>::iterator iCurrentPlayer;
	vector<Hai> Yama;
	vector<Hai>::iterator iYama;
	vector<Hai> Dora;
       
	int GameState; 
//void haipai(class Player* p);
	vector<Hai>::iterator iLastTsumo;
	void haipai();
	void dealHai();
	
	
public:
	Game();
	~Game();

	void handleAction(string, string, string);
	int addPlayer(class User*);
	void start();
	void initGame();
	void initYama();
	void newRound();
	void initDora();
	
};




#endif
